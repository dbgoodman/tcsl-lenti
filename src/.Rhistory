# incucyte_dt[, std_error := std_dev/sqrt(.N), by=c('day','donor','car','Elapsed','measurement','k562')]
car_set <- c('41BB','CD28','BAFF-R','KLRG1','TACI', 'none')
colors <- c(brewer.pal(9,'Blues')[c(6,8)], brewer.pal(9,'Greens')[c(5,7,9)], 'grey30')
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd4' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"))
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd8' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd8_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,65)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors, show.legend=F) +
scale_fill_manual(values=colors, show.legend=F) +
theme(panel.spacing = unit(2, "lines"))
#
# incucyte_dt[, value_norm := value/value[Elapsed==0], by=c('well','day','donor','car','measurement','k562','image')]
# incucyte_dt[, mean_value_norm := mean(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_dev := sd(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_error := std_dev/sqrt(.N), by=c('day','donor','car','Elapsed','measurement','k562')]
car_set <- c('41BB','CD28','BAFF-R','KLRG1','TACI', 'none')
colors <- c(brewer.pal(9,'Blues')[c(6,8)], brewer.pal(9,'Greens')[c(5,7,9)], 'grey30')
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd4' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"))
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd8' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd8_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,65)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"), legend.position = 'none')
library(cowplot)
plot_grid(cd4_banff, cd8_banff, ncol=1)
#
# incucyte_dt[, value_norm := value/value[Elapsed==0], by=c('well','day','donor','car','measurement','k562','image')]
# incucyte_dt[, mean_value_norm := mean(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_dev := sd(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_error := std_dev/sqrt(.N), by=c('day','donor','car','Elapsed','measurement','k562')]
car_set <- c('41BB','CD28','BAFF-R','KLRG1','TACI', 'none')
colors <- c(brewer.pal(9,'Blues')[c(6,8)], brewer.pal(9,'Greens')[c(5,7,9)], 'grey30')
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd4' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"))
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd8' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd8_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,65)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"))
library(cowplot)
plot_grid(cd4_banff, cd8_banff, ncol=1)
plot_grid(cd4_banff, cd8_banff, ncol=1)
#
# incucyte_dt[, value_norm := value/value[Elapsed==0], by=c('well','day','donor','car','measurement','k562','image')]
# incucyte_dt[, mean_value_norm := mean(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_dev := sd(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_error := std_dev/sqrt(.N), by=c('day','donor','car','Elapsed','measurement','k562')]
car_set <- c('41BB','CD28','BAFF-R','KLRG1','TACI', 'none')
colors <- c(brewer.pal(9,'Blues')[c(6,8)], brewer.pal(9,'Greens')[c(5,7,9)], 'grey30')
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd4' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"))
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd8' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd8_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,65)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"))
library(cowplot)
plot_grid(cd4_banff, cd8_banff, ncol=1)
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"))
#
# incucyte_dt[, value_norm := value/value[Elapsed==0], by=c('well','day','donor','car','measurement','k562','image')]
# incucyte_dt[, mean_value_norm := mean(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_dev := sd(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_error := std_dev/sqrt(.N), by=c('day','donor','car','Elapsed','measurement','k562')]
car_set <- c('41BB','CD28','BAFF-R','KLRG1','TACI', 'none')
colors <- c(brewer.pal(9,'Blues')[c(6,8)], brewer.pal(9,'Greens')[c(5,7,9)], 'grey30')
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd4' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"))
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd8' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd8_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,65)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(2, "lines"))
library(cowplot)
plot_grid(cd4_banff, cd8_banff, ncol=1)
plot_grid(cd4_banff, cd8_banff, ncol=1)
#
# incucyte_dt[, value_norm := value/value[Elapsed==0], by=c('well','day','donor','car','measurement','k562','image')]
# incucyte_dt[, mean_value_norm := mean(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_dev := sd(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_error := std_dev/sqrt(.N), by=c('day','donor','car','Elapsed','measurement','k562')]
car_set <- c('41BB','CD28','BAFF-R','KLRG1','TACI', 'none')
colors <- c(brewer.pal(9,'Blues')[c(6,8)], brewer.pal(9,'Greens')[c(5,7,9)], 'grey30')
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd4' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(0.5, "lines"))
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd8' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd8_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,65)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(0.5, "lines"))
library(cowplot)
plot_grid(cd4_banff, cd8_banff, ncol=1)
plot_grid(cd4_banff, cd8_banff, ncol=1)
#
# incucyte_dt[, value_norm := value/value[Elapsed==0], by=c('well','day','donor','car','measurement','k562','image')]
# incucyte_dt[, mean_value_norm := mean(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_dev := sd(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_error := std_dev/sqrt(.N), by=c('day','donor','car','Elapsed','measurement','k562')]
car_set <- c('41BB','CD28','BAFF-R','KLRG1','TACI', 'none')
colors <- c(brewer.pal(9,'Blues')[c(6,8)], brewer.pal(9,'Greens')[c(5,7,9)], 'grey30')
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd4' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150), breaks=c(40, 80, 120)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(0.5, "lines"))
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd8' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd8_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,65), breaks=c(15, 30, 45)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(0.5, "lines"))
library(cowplot)
#plot_grid(cd4_banff, cd8_banff, ncol=1)
plot_grid(cd4_banff, cd8_banff, ncol=1)
#
# incucyte_dt[, value_norm := value/value[Elapsed==0], by=c('well','day','donor','car','measurement','k562','image')]
# incucyte_dt[, mean_value_norm := mean(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_dev := sd(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_error := std_dev/sqrt(.N), by=c('day','donor','car','Elapsed','measurement','k562')]
car_set <- c('41BB','CD28','BAFF-R','KLRG1','TACI', 'none')
colors <- c(brewer.pal(9,'Blues')[c(6,8)], brewer.pal(9,'Greens')[c(5,7,9)], 'grey30')
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd4' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150), breaks=c(0, 40, 80, 120)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(0.5, "lines"))
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd8' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd8_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=20) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,65), breaks=c(0, 15, 30, 45)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(0.5, "lines"))
library(cowplot)
#plot_grid(cd4_banff, cd8_banff, ncol=1)
plot_grid(cd4_banff, cd8_banff, ncol=1)
plot_grid(cd4_banff, cd8_banff, ncol=1)
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=18) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150), breaks=c(0, 40, 80, 120)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(0.5, "lines"))
#
# incucyte_dt[, value_norm := value/value[Elapsed==0], by=c('well','day','donor','car','measurement','k562','image')]
# incucyte_dt[, mean_value_norm := mean(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_dev := sd(value_norm), by=c('day','donor','car','Elapsed','measurement','k562')]
# incucyte_dt[, std_error := std_dev/sqrt(.N), by=c('day','donor','car','Elapsed','measurement','k562')]
car_set <- c('41BB','CD28','BAFF-R','KLRG1','TACI', 'none')
colors <- c(brewer.pal(9,'Blues')[c(6,8)], brewer.pal(9,'Greens')[c(5,7,9)], 'grey30')
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd4' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd4_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=18) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,150), breaks=c(0, 40, 80, 120)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(0.5, "lines"))
incucyte_dt_subset <- incucyte_dt[
k562=='mkate_cd19' & !noise & t_type == 'cd8' &
measurement == chosen_measure & car %in% car_set
& donor < 3 ][,
car := factor(
car,
levels=c('CD28', '41BB', 'BAFF-R', 'KLRG1', 'TACI', 'none'),
labels=c('CD28', '41BB', 'Receptor 1', 'Receptor 3', 'Receptor 4', 'No T cells')
)]
cd8_banff <- ggplot(incucyte_dt_subset,
aes(x=Elapsed, y=mean_value_norm, group=interaction(car, day_f,donor), fill=car)) +
geom_smooth(aes(color=car), method='loess', se=T) +
facet_grid(t_type+donor~day_f) +
theme_minimal(base_size=18) + geom_vline(xintercept=0) + geom_hline(yintercept=0) +
theme(plot.title = element_text(size = 25)) +
scale_x_continuous(expand=c(0,0), limits=c(0,65), breaks=c(0, 15, 30, 45)) +
scale_y_continuous('mKate Total Integrated Intensity\n(normalized to starting)',
limits=c(1e-2,1e1), trans=log10_trans(), labels = scales::percent_format(accuracy = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values=colors) +
scale_fill_manual(values=colors) +
theme(panel.spacing = unit(0.5, "lines"))
library(cowplot)
#plot_grid(cd4_banff, cd8_banff, ncol=1)
plot_grid(cd4_banff, cd8_banff, ncol=1)
require(data.table)
require(ggplot2)
require(scales)
require(here)
require(flowCore)
require(flowWorkspace)
require(RColorBrewer)
library(ggridges)
